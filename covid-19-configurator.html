<!DOCTYPE html>
<html lang="en">

<head>
	<title>COVID-19-Configurator</title>
	<meta charset="utf-8">

	<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">

	<meta name="description" content="COVID-19 Configurator">
	<meta name="keywords" content="COVID-19, Coronavirus, SARS-CoV-2, Coronavirus disease 2019, Configurator">
	<meta name="author" content="Pavel Boytchev">
	<meta name="version" content="1.0">
	<meta name="date" content="2021.08.12">
	
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;500;700&display=swap" rel="stylesheet">

	<link rel="stylesheet" href="covid-19-configurator.css">

	<script src="covid-19-configurator.js"></script> 
	
</head>

<body>
<div class="page">
<h2>COVID-19 Configurator
	<div class="info">The COVID-19 simulation is controlled by <span id="param_count"></span> parameters. Click on the name of a parameter to add or remove it from
	the list of your favourite parameters. DEBUG parameters are used to introduce
	specific situation or behaviour. The information from this page is
	stored only locally &ndash; it is not transmitted anywhere.
	<button onclick="resetConfigurator()">Reset</button>
	<button onclick="debugConfigurator()">Debug</button>
	</div>
</h2>
	
	
	Show:
	<label class="filters"><input type="radio" name="show" id="show-fav" checked onchange="toggleFilter()"><span>My</span></label>
    <label class="filters"><input type="radio" name="show" id="show-all" onchange="toggleFilter()"><span>All</span></label>
    <label class="filters"><input type="radio" name="show" id="show-main" onchange="toggleFilter()"><span>Main</span></label>

	<div class="start-block">
		<a class="start" href="covid-19-simulator.html" onclick="prepareValues()">Start simulation</a>
	</div>
	<div id="blocks">
	</div> <!--id="blocks"-->
	<div class="start-block end">
		<a class="start" href="covid-19-simulator.html" onclick="prepareValues()">Start simulation</a>
	</div>
	<br>

</div> <!--page-->	


	<script>
		addNumeric(
			'gs', 'Ground size', 500, {min:10, max:10000, step:10, fav:true, unit:'m'},
			'The active area of the simulation in meters. Buildings and people will be bound to a square of this size.' );

		addNumeric(
			'es', 'Earth size', 50000, {min:1000, max:100000, step:1000, unit:'m', offset: 7.4},
			'The area surrounding the simulation area. Its edge makes the horizon.' );

		addNumeric(
			'rs', 'Random layout', 0, {min:0, max:100000, step:1, debug:true},
			'The number that determines the layout of streets and buildings. If 0, the simulator will pick an arbitrary layout. It not 0, the simulator will use that spacific layout if the other configuration parameters are the same.' );

		addNumeric(
			'damc', 'Agent count', 100, {min:0, max:50000, step:100, fav:true},
			'The maximal number of people in the simulation. Their number might be smaller if the amount of houses and apartments are not sufficient for all of them.' );

		addBoolean(
			'drw', 'RANDOM WANDERING', false, {debug:true},
			'If checked, the people are walking in random directions and they do not follow any routine. If not checked, the people follow their daily routine.' );

		addBoolean(
			'dfal', 'Line formation', false, {debug:true},
			'If checked, the people are positioned in lines and columns. If not checked, the people are positioned in buildings.' );

		addTime(
			'dts', 'Time speed', timeMs(0,0,1), {min:timeMs(0,0,1), max:timeMs(1,0,0), step:timeMs(0,0,1),debug:true},
			'How much virtual time passes for 1 second of real time. For example, 00:00:01 is for realtime simulation, 00:00:05 is for simulation 5 times faster.' );

		addTime(
			'st', 'Start time', timeMs(6,20), {min:timeMs(0,0,0), max:timeMs(23,59,59), step:timeMs(0,10,0),debug:true},
			'The virtual time at which the simulation starts.' );

		addBoolean(
			'dbwoh', 'Blocks with houses', false, {debug:true},
			'If checked, generate blocks with houses. However, all <em>Blocks with ...</em> parameters are altogether not checked, then blocks with houses are generated.' );

		addBoolean(
			'dbwoa', 'Blocks with apartments', false, {debug:true},
			'If checked, generate blocks with apartments. However, all <em>Blocks with ...</em> parameters are altogether not checked, then blocks with apartments are generated.' );

		addBoolean(
			'dbwoo', 'Blocks with offices', false, {debug:true},
			'If checked, generate blocks with offices. However, all <em>Blocks with ...</em> parameters are altogether not checked, then blocks with offices are generated.' );

		addBoolean(
			'dbwop', 'Blocks with parks', false, {debug:true},
			'If checked, generate blocks with parks. However, all <em>Blocks with ...</em> parameters are altogether not checked, then blocks with parks are generated.' );

		addBoolean(
			'dbwoz', 'Blocks with plazas', false, {debug:true},
			'If checked, generate blocks with plazas. However, all <em>Blocks with ...</em> parameters are altogether not checked, then blocks with plazas are generated.' );

		addBoolean(
			'dar', 'Auto rotate', false, {debug:true},
			'If checked, the scene rotates continuously with speed defined by <em>Auto rotate speed</em>. The user can still use the mouse to rotate manually. If not checked, the scene does not move by itself.' );

		addNumeric(
			'dars', 'Auto rotate speed', 0.3, {min:0, max:1, step:0.1, debug:true, unit:'rad/s', offset: 7},
			'The speed of automatic rotation measure in radians per second. The value is effective only if <em>Auto rotate</em> is checked, otherwise it has no effect.' );

		addBoolean(
			'dri', 'Renderer info', false, {debug:true},
			'If checked, shows renderer info (once per 10000 frames) in the JS console &ndash; number of geometries, textures, calls, lines, points and triangles.' );

		addPercentage(
			'dbuo', 'Building opacity', 1, {min:0, max:1, step:0.25, debug:true},
			'Percentage of opacity of all buildings &ndash; houses, apartments and offices. At 100% the buildings are fully opaque, while at 0% they are fully transparent.' );
			
		addPercentage(
			'dblo', 'Ground opacity', 1, {min:0, max:1, step:0.25, debug:true},
			'Percentage of opacity of the ground &ndash; pavements, streets, grass. At 100% the ground is fully opaque, while at 0% it is fully transparent.' );
			
		addPercentage(
			'dnmo', 'Navmesh opacity', 0, {min:0, max:1, step:0.25, debug:true},
			'Percentage of opacity of the navigational mesh (navmesh) &ndash; crimson and orange areas showing locations of rooms, elevators, checkpoints, etc. At 100% the navmesh is fully opaque, while at 0% it is fully transparent. Navmeshes are shown on top of buildings and other 3D objects.' );
			
		addBoolean(
			'dnmsf', 'Navmesh floors', false, {debug:true},
			'If checked, generates images of navmesh rooms at the floor level. However, they are shown only if <em>Navmesh opacity</em> is not 0%.' );

		addBoolean(
			'dnmsl', 'Navmesh routes', false, {debug:true},
			'If checked, generates images of navmesh routes. However, they are shown only if <em>Navmesh opacity</em> is not 0%.' );

		addBoolean(
			'dnmse', 'Navmesh elevators', false, {debug:true},
			'If checked, generates images of navmesh elevators. However, they are shown only if <em>Navmesh opacity</em> is not 0%.' );

		addBoolean(
			'dsaad', 'Age diagram', false, {debug:true},
			'If checked, shows a diagram of age distribution of people (number of people per age in years). The theoretical distribution is shown in crimson, the actual distribution is shown in blue. Click on the diagram to hide it.' );

		addBoolean(
			'dsvs', 'Viral diagram', false, {debug:true},
			'If checked, shows a diagram of the viral shedding (infection level per time period). Higher values indicate higher probability of infecting nearby people. Vertical lines split the diagram into 14 periods. Click on the diagram to hide it.' );

		addBoolean(
			'dhr', 'Hide roofs', false, {debug:true},
			'If checked, buildings are drawn without roofs and it is possibel to see people inside.' );

		addBoolean(
			'dcvoa', 'Look at people', false, {debug:true},
			'If checked, when the simulation starts, sets the view point on the people. This can be used to find people if they are a small compact group in a large city.' );

		addNumeric(
			'dfa', 'Follow person', -1, {min:-1, max:50000, step:1, debug:true},
			'Each person has an id number starting from 0. If this parameter cointains an existing person id, then the view point automatically follows this person as if spied from a drone. If the value is -1, such following is turned off.' );

		addNumeric(
			'dfah', 'Follow person health', -1, {min:-1, max:50000, step:1, debug:true},
			'If this parameter cointains an existing person id, then the health status of this person is printed in the JS console. If the value is -1, such printing is turned off.' );

		addBoolean(
			'dsd', 'Show directions', false, {debug:true},
			'If checked, prints the directions and axes outside the city boundary. The orientation is as if the city is looked from below.' );

		addBoolean(
			'daaf', 'Apartment floors', false, {debug:true},
			'If checked, the floors of the apartment building are drawn. To see the floors the view point should be inside the building or <em>Building opacity</em> should be less than 100%.' );

		addBoolean(
			'dshtwa', 'Home-to-work arrow', false, {debug:true},
			'If checked, an arrow is generated for each person pointing from home to office location.' );

		addBoolean(
			'dsr', 'Show route', false, {debug:true},
			'If checked, show the route of each person as a sequence of arrows.' );

		addBoolean(
			'ddr', 'Print route', false, {debug:true},
			'If checked, prints the route of each person in the JS console. This parameter is checked when there are a few people, preferable exactly one, i.e. <em>Agent count</em>=1.' );

		addNumeric(
			'drpa', 'Routes per person', 1, {min:1, max:200, step:1, debug:true},
			'The number of routes generated for each person. Independent on the value, onle one of the routes is used. THe others only indicate what possibilities exists. This parameter is often used with <em>Show route</em> checked and <em>Agent count</em>=1.' );

		addNumeric(
			'daa', 'Follow person actions', -1, {min:-1, max:50000, step:1, debug:true},
			'If this parameter cointains an existing person id, then the timestamped actions of  this person are printed in the JS console. If the value is -1, such printing is turned off.' );

		addBoolean(
			'dal', 'Population whereabouts', false, {debug:true},
			'If checked, once per second prints in the JS console the number of people at home, commuting and at work.' );
			
		addBoolean(
			'dah', 'Population health', false, {debug:true},
			'If checked, once per second prints in the JS console the number of infected people.' );
			
		addBoolean(
			'dspg', 'Manual sun', false, {debug:true},
			'If checked, adds a control for manually changing the sun position. This affects lightings and shadows (if they are turned on). The position is set as hours &ndash; i.e. 18.5 corresponds to 18:30.' );
			
		addBoolean(
			'daw', 'All white', false, {debug:true},
			'If checked, all buildings, trees and the ground are white. People colours are not affected.' );
			
		addBoolean(
			'cs', 'Cartoon style', false, {debug:true},
			'If checked, people, houses and trees are drawn in cartoon style &ndash white with heavy contrast shading.' );
			
		addNumeric(
			'bst', 'Block split treshold', 110, {min:50, max:500, step:10, unit:'m'},
			'This parameter is used when the city layout is generated. If a block is larger than this value, then it is considered for splitting into smaller blocks.' );

		addNumeric(
			'bm', 'Block split margin', 30, {min:10, max:100, step:10, unit:'m'},
			'If a block is split into smaller blocks, they must be larger than this number. <em>Block split margin</em> should not exceed <em>Block split treshold/3</em>, if it exeeds it, then <em>Block split treshold/3</em> will be used. If the value is too small, it may prevent the formation of sloped streets in the city.' );

		addPercentage(
			'bpp', 'Park probability', 0.05, {min:0, max:1, step:0.01},
			'Probability of a block to be generated as a park. Larger values make more green open areas in the city. Too small residential blocks will be turned into parks independent on this parameter.' );

		addPercentage(
			'bzp', 'Plaza probability', 0.03, {min:0, max:1, step:0.01},
			'Probability of a block to be generated as a plaza. Larger values make more open areas in the city. This probability is tested after <em>Park probability</em>.' );

		addPercentage(
			'ovr', 'Office vs residential', 0.05, {min:-1, max:1, step:0.01},
			'The probability of a block to be for office buildings or for residential buildings depends on the computed maximal height of the block. <em>Office vs residential</em> contributes to this probability by increasig or decreasing it. Value 100% generates only office buildings; value -100% generates only residential buildings; value 0% keeps the originally computed probability.</em>.' );

		addNumeric(
			'sw', 'Street width', 6, {min:1, max:20, step:1, unit:'m'},
			'Street width in meters. Blocks are split by streets of this size.' );

		addNumeric(
			'aw', 'Avenue width', 18, {min:1, max:40, step:1, unit:'m'},
			'Avenue width in meters. Exceptionally large blocks are initially split by avenues of this size.' );

		addNumeric(
			'at', 'Avenue treshold', 1000, {min:100, max:2000, step:100, unit:'m'},
			'If a block is larger than this size, it might be split by an avenue, otherwise &ndash; by a street.' );

		addPercentage(
			'sut', 'Suburb treshold', 0.16, {min:0, max:1, step:0.01},
			'Percentage of <em>Ground size</em>. If a block is larger than this size and it is in the suburbs of the city, it might be made as park. This makes the shape of the city less squarish.' );

		addPercentage(
			'urru', 'Rural-urban', 0.3, {min:0, max:1, step:0.1},
			'Percentage of how rural or urban is the generated area. Approximate values are: 100% for vilages, 70% for small towns, 50% for towns, 30% for cities and 0% for megalopolises. The effect is visible when <em>Ground size</em> is larger (at least a few kilometers).' );

		addPercentage(
			'sks', 'Skyscrapers', 0.2, {min:-1, max:1, step:0.1},
			'The probability of a skyscaper depends on the computed maximal height of the block. <em>Skyscrapers</em> contributes to this probability by increasig or decreasing it. Value 100% generates mostly skyscrapers; value -100% tries to avoid them.</em>.' );

		addNumeric(
			'fh', 'Floor height', 2.5, {min:1, max:4, step:0.1, unit:'m'},
			'Height of a floor (storey) in meters. The same height is used for all buildings &ndash; residential and business.' );

		addNumeric(
			'mf', 'Maximal floors', 120, {min:10, max:400, step:10},
			'Maximal number of floors in in the tallest buildigs.' );

		addNumeric(
			'hbr', 'House bounding radius', 5, {min:4, max:20, step:1},
			'The radius of invisible circle around a house. It determins how wide a house can be, how close it to neghtbour houses and how it is positioned in a block. Larger radius makes sparse house distribution.' );





		document.getElementById( 'param_count' ).innerHTML = ids.length;
		
		var filter = localStorage.getItem( LOCAL_STORAGE_FILTER ) || 'show-fav';
		document.getElementById( filter ).checked = true;
		toggleFilter();
	</script>
	
</body>
</html>
